@import play.api.libs.json.JsValue
@import play.api.libs.json.Json
@import models.api._

@import models.domain.DataSourceDescription
@import models.domain.DonationDataSourceType.DonationDataSourceType

@(dataSource: String)(implicit request: RequestHeader, messages: Messages)

<div class="modal-dialog modal-lg">
    <div class="modal-content">
        <div class="modal-header bgmain">
            <h3 class="data-protection-headline">More... Blue background good or distracting?</h3>
            <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">

            <div
            id="@{
                dataSource.toString
            }ModalContainer"
            >
                @showSentReceivedPlot(dataSource)
                @showSentReceivedOverallGraphPlot(dataSource)
                @showSentReceivedSlidingWindowMeanGraphPlot(dataSource)
                @showSentReceivedWordsGraphPlot(dataSource)
                @showSentReceivedDailyPerConversationGraphPlot(dataSource)
            </div>


            <div class="d-flex justify-content-end align-items-center">
                <button type="button" class="btn footer-backward-button consent-button" data-dismiss="modal">@messages("consent.buttons.close.caption")</button>

            </div>
        </div>
    </div>

    @showExplanationText(title: String, body: String) = {
        <div class="top">
            <h4 class="text-center font-weight-bold insights-header">@title</h4>
        </div>
        <div class="card-deck feedback-stats-deck">

            <div class="card top feedback-stats-card">
                <p class="insights-text text-center">
                @body
                </p>
            </div>

        </div>
    }

    @showSentReceivedPlot(name: String) = {
    @showExplanationText("Monthly Sent Received Messages", "This was one of the two plots already implemented in Dona. (As I will focus on sent/received words rather than messages -> maybe remove this? Or keep it?)")
        <div id="@{
            name.toString
        }MessagesOverTime" class="d-none"
        data-x-axis="@messages("feedback.graph.time")"
        data-y-axis="@messages("feedback.graph.number-of-messages")"
        data-sent-trace-name="@messages("feedback.graph.sent")"
        data-received-trace-name="@messages("feedback.graph.received")"
        >
            <div class="card h-100">
                <div class="m-auto">@messages("feedback.graph.loading")</div>
            </div>
        </div>
        <div class="clearfix"></div>
    }

    @showSentReceivedOverallGraphPlot(name: String) = {
    @showExplanationText("Daily Sent Received Messages", "Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.")

        <div id="@{
            name
        }SentReceivedOverall" class="d-none"
        data-x-axis="@messages("feedback.graph.time")"
        data-y-axis="@messages("feedback.graph.number-of-messages")"
        data-sent-trace-name="@messages("feedback.graph.sent")"
        data-received-trace-name="@messages("feedback.graph.received")"
        >
            <div class="card h-100">
                <div class="m-auto">@messages("feedback.graph.loading")</div>
            </div>
        </div>

        <div class="clearfix"></div>
    }

    @showSentReceivedSlidingWindowMeanGraphPlot(name: String) = {
    @showExplanationText("Daily Sent Received Messages Sliding Window Mean", "Calculating the sliding window mean (window size 29 days) for sent/received messages. THIS MIGHT BE BROKEN RIGHT NOW!")

        <div id="@{
            name
        }SentReceivedSevenDayAverages" class="d-none"
        data-x-axis="@messages("feedback.graph.time")"
        data-y-axis="@messages("feedback.graph.number-of-messages")"
        data-sent-trace-name="@messages("feedback.graph.sent")"
        data-received-trace-name="@messages("feedback.graph.received")"
        >
            <div class="card h-100">
                <div class="m-auto">@messages("feedback.graph.loading")</div>
            </div>
        </div>

        <div class="clearfix"></div>
    }

    @showSentReceivedWordsGraphPlot(name: String) = {
    @showExplanationText("Daily Sent Received Words", "Lorem ipsum dolor sit amet, consetetur sadipscing elitr, sed diam nonumy eirmod tempor invidunt ut labore et dolore magna aliquyam erat, sed diam voluptua. At vero eos et accusam et justo duo dolores et ea rebum. Stet clita kasd gubergren, no sea takimata sanctus est Lorem ipsum dolor sit amet.")


        <div id="@{
            name
        }WordsSentReceivedOverall" class="d-none"
        data-x-axis="@messages("feedback.graph.time")"
        data-y-axis="@messages("feedback.graph.number-of-messages")"
        data-sent-trace-name="@messages("feedback.graph.sent")"
        data-received-trace-name="@messages("feedback.graph.received")"
        >
            <div class="card h-100">
                <div class="m-auto">@messages("feedback.graph.loading")</div>
            </div>
        </div>

        <div class="clearfix"></div>
    }


    @showSentReceivedDailyPerConversationGraphPlot(name: String) = {
    @showExplanationText("Daily Sent Received Messages (with conversation selector)", "TODO: Implement selector with plotly.js instead of html... also change to count of words instead of messages... maybe make one plot with options: Total, conv1, conv2, ...")


        <div id="@{
            name
        }DailySentReceivedPerConversation" class="d-none"
        data-x-axis="@messages("feedback.graph.time")"
        data-y-axis="@messages("feedback.graph.number-of-messages")"
        data-sent-trace-name="@messages("feedback.graph.sent")"
        data-received-trace-name="@messages("feedback.graph.received")"
        >
            <div class="card h-100">
                <div class="m-auto">@messages("feedback.graph.loading")</div>
            </div>
        </div>
        <div class="control-row">
            Conversation: <select class="@{
            name
        }ConversationsSentReceivedDaily">
        </select>
        </div>

        <div class="clearfix"></div>
    }
</div>